<?phprequire 'Library/Router.php';require 'Config/Traffic.php';class App {    protected $controle;    protected $metodo;    private $free = array();    function __construct($url) {        $this->loadRoute($url);    }    public function metodo($varSite, $varSistema, $url) {        if ($url === $varSite['rota']) {            $this->controle = $varSite['controller'];            $this->metodo = $varSite['method'];        }        for ($ind = 0; $ind < count($varSistema); $ind++) {            if ($url === $varSistema[$ind]['rota']) {                $this->controle = $varSistema[$ind]['controller'];                $this->metodo = $varSistema[$ind]['method'];            }        }    }    function loadRoute($url) {        $liberado = array('', 'home', 'empresa', 'contato', 'login', 'sistema',                          'blog','escritorio','eniviarEmail','servicos','relatorio',                          'montaResumo','selecionaBanner','noticias','single',                          'enviarEmailSite','agendar','agenda','assine','carregaCidade','selectDatas',);        $this->free = new Router();        if ($url === '') {            $url = 'home';        }        if (!in_array($url, $liberado)) {            $varSistema = $this->free->selecionaSistema();        }        if (in_array($url, $liberado)) {                        if (!isset($this->traffic)) {                $this->traffic = new Traffic();                $this->traffic->loadTraffic();            }            $this->traffic->loadTraffic();            $varSite = $this->free->selecionaSite($url);        }        $this->metodo($varSite, $varSistema, $url);    }    function dispacher() {        if (!isset($this->controle)) {            $this->controle = 'Website';            $this->metodo = 'rotaInexistente';        }        $st_controller_file = $_SERVER["DOCUMENT_ROOT"] . 'App/Controllers/' . $this->controle . 'Controller.php';        if (file_exists($st_controller_file)) {            require_once $st_controller_file;        } else {            throw new Exception('Arquivo ' . $st_controller_file . ' nao encontrado');        }        $st_class = $this->controle . "Controller";        if (class_exists($st_class)) {            $o_class = new $st_class;        } else {            throw new Exception("Classe '$st_class' nao existe no arquivo '$st_controller_file'");        }        $metodo = $this->metodo . 'Action';        if (method_exists($o_class, $metodo)) {            $o_class->$metodo();        } else {            throw new Exception("Metodo '$metodo' nao existe na classe $st_class'");        }    }    static function redirect($st_uri) {        header("Location: $st_uri");    }}